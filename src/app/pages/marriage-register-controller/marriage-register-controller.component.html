<div class="marriage-container">
    <!-- Header Section -->
    <div class="marriage-header">
        <div class="header-top">
            <div class="header-title">
                <h1>Marriage Register - Adults</h1>
                <p>Manage marriage records for adults</p>
            </div>
            <button (click)="onAddNew()" type="button" class="btn-primary">
                <span class="material-icons">add</span>
                Add New Record
            </button>
        </div>

        <!-- Search and Filter Bar -->
        <div class="search-bar">
            <div class="search-input-wrapper">
                <span class="material-icons">search</span>
                <input type="text" [(ngModel)]="searchQuery" (ngModelChange)="onSearchChange()" class="search-input"
                    placeholder="Search by name...">
            </div>
            <button class="btn-filter">
                <span class="material-icons">filter_list</span>
                Filter
            </button>
        </div>
    </div>

    <!-- Loading State -->
    <div *ngIf="isLoading" class="loading-spinner">
        <div class="spinner"></div>
    </div>

    <!-- Error Message -->
    <div *ngIf="errorMessage" class="alert alert-error">
        <span class="material-icons">error</span>
        <p>{{ errorMessage }}</p>
    </div>

    <!-- Success Message -->
    <div *ngIf="successMessage" class="alert alert-success">
        <span class="material-icons">check_circle</span>
        <p>{{ successMessage }}</p>
    </div>

    <!-- Table -->
    <div class="table-container" *ngIf="!isLoading">
        <table class="marriage-table">
            <thead>
                <tr>
                    <th class="sortable" (click)="onSort('dateOfMarriage')">Marriage Date</th>
                    <th>Groom Name</th>
                    <th>Bride Name</th>
                    <th>Place</th>
                    <th>Solemnized By</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let record of filteredRecords; let i = index">
                    <td>{{ record.dateOfMarriage | date:'dd / MM / yyyy' }}</td>
                    <td><strong>{{ record.groomName }}</strong></td>
                    <td><strong>{{ record.brideName }}</strong></td>
                    <td>{{ record.placeOfMarriage }}</td>
                    <td>{{ record.solemnizedBy }}</td>
                    <td>
                        <div class="action-buttons">
                            <button (click)="onView(record)" class="action-btn" title="View">
                                <span class="material-icons">visibility</span>
                            </button>
                            <button (click)="onEdit(record)" class="action-btn" title="Edit">
                                <span class="material-icons">edit</span>
                            </button>
                            <button (click)="onDelete(record)" class="action-btn delete" title="Delete">
                                <span class="material-icons">delete</span>
                            </button>
                        </div>
                    </td>
                </tr>
                <tr *ngIf="filteredRecords.length === 0">
                    <td colspan="6">
                        <div class="empty-state">
                            <span class="material-icons">search_off</span>
                            <p>No records found</p>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>

        <!-- Pagination -->
        <div class="pagination">
            <div class="pagination-info">
                Showing <span class="font-medium">{{ currentPage * pageSize + 1 }}</span> to
                <span class="font-medium">{{ (currentPage + 1) * pageSize > totalElements ? totalElements : (currentPage
                    + 1) * pageSize }}</span> of
                <span class="font-medium">{{ totalElements }}</span> results
            </div>
            <div class="pagination-controls">
                <button (click)="onPreviousPage()" [disabled]="!hasPreviousPage" class="page-btn">
                    <span class="material-icons">chevron_left</span>
                </button>
                <button *ngFor="let page of getPageNumbers()" (click)="onGoToPage(page)"
                    [class.active]="page === currentPage" class="page-btn">
                    {{ page + 1 }}
                </button>
                <button (click)="onNextPage()" [disabled]="!hasNextPage" class="page-btn">
                    <span class="material-icons">chevron_right</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Modal -->
    <div *ngIf="showModal" class="modal-overlay">
        <div class="modal-backdrop" (click)="onCancel()"></div>
        <div class="modal-wrapper">
            <div class="modal-panel">
                <div class="modal-content">
                    <!-- Modal Header -->
                    <div class="modal-header">
                        <h3>{{ isEditMode ? 'Edit' : 'Add' }} Marriage Record</h3>
                        <button (click)="onCancel()" class="modal-close">
                            <span class="material-icons">close</span>
                        </button>
                    </div>

                    <form [formGroup]="marriageForm" (ngSubmit)="onSaveRecord()">
                        <!-- Marriage Information Section -->
                        <div class="form-section">
                            <h4 class="section-title">Marriage Information</h4>
                            <p class="section-subtitle">Basic details about the marriage</p>

                            <div class="form-grid">
                                <div>
                                    <label class="form-label">Date of Marriage <span class="required">*</span></label>
                                    <input type="date" formControlName="dateOfMarriage" required class="form-input">
                                </div>
                                <div>
                                    <label class="form-label">Place of Marriage <span class="required">*</span></label>
                                    <input type="text" formControlName="placeOfMarriage" required class="form-input">
                                </div>
                                <div class="form-grid-full">
                                    <label class="form-label">Solemnized By <span class="required">*</span></label>
                                    <input type="text" formControlName="solemnizedBy" required class="form-input">
                                </div>
                            </div>
                        </div>

                        <!-- Groom Information Section -->
                        <div class="form-section">
                            <h4 class="section-title">Groom Information</h4>
                            <p class="section-subtitle">Details about the groom</p>

                            <div class="form-grid">
                                <div class="form-grid-full">
                                    <label class="form-label">Groom Name <span class="required">*</span></label>
                                    <input type="text" formControlName="groomName" required class="form-input">
                                </div>
                                <div>
                                    <label class="form-label">Date of Birth</label>
                                    <input type="date" formControlName="groomDob" class="form-input">
                                </div>
                                <div>
                                    <label class="form-label">Condition</label>
                                    <!-- <input type="text" formControlName="groomCondition" class="form-input"
                                        placeholder="e.g., Bachelor, Widower"> -->
                                    <select formControlName="groomCondition" class="form-input">
                                        <option value="">Select Condition</option>
                                        <option value="Bachelor">Bachelor</option>
                                        <option value="Widower">Widower</option>
                                        <option value="Divorcee">Divorcee</option>
                                    </select>
                                </div>
                                <div class="form-grid-full">
                                    <label class="form-label">Father Name <span class="required">*</span></label>
                                    <input type="text" formControlName="groomFather" required class="form-input">
                                </div>
                                <div>
                                    <label class="form-label">Profession</label>
                                    <input type="text" formControlName="groomProfession" class="form-input">
                                </div>
                                <div>
                                    <label class="form-label">Residence</label>
                                    <input type="text" formControlName="groomResidence" class="form-input">
                                </div>
                            </div>
                        </div>

                        <!-- Bride Information Section -->
                        <div class="form-section">
                            <h4 class="section-title">Bride Information</h4>
                            <p class="section-subtitle">Details about the bride</p>

                            <div class="form-grid">
                                <div class="form-grid-full">
                                    <label class="form-label">Bride Name <span class="required">*</span></label>
                                    <input type="text" formControlName="brideName" required class="form-input">
                                </div>
                                <div>
                                    <label class="form-label">Date of Birth</label>
                                    <input type="date" formControlName="brideDob" class="form-input">
                                </div>
                                <div>
                                    <label class="form-label">Condition</label>
                                    <!-- <input type="text" formControlName="brideCondition" class="form-input"
                                        placeholder="e.g., Spinster, Widow"> -->
                                    <select formControlName="brideCondition" class="form-input">
                                        <option value="">Select Condition</option>
                                        <option value="Spinster">Spinster</option>
                                        <option value="Widow">Widow</option>
                                        <option value="Divorcee">Divorcee</option>
                                    </select>
                                </div>
                                <div class="form-grid-full">
                                    <label class="form-label">Father Name <span class="required">*</span></label>
                                    <input type="text" formControlName="brideFather" required class="form-input">
                                </div>
                                <div>
                                    <label class="form-label">Profession</label>
                                    <input type="text" formControlName="brideProfession" class="form-input">
                                </div>
                                <div>
                                    <label class="form-label">Residence</label>
                                    <input type="text" formControlName="brideResidence" class="form-input">
                                </div>
                            </div>
                        </div>

                        <!-- Witnesses Section -->
                        <div class="form-section">
                            <h4 class="section-title">Witnesses</h4>
                            <p class="section-subtitle">Witness information</p>

                            <div class="form-grid">
                                <div>
                                    <label class="form-label">Witness 1 <span class="required">*</span></label>
                                    <input type="text" formControlName="witness1Name" required class="form-input">
                                </div>
                                <div>
                                    <label class="form-label">Witness 2</label>
                                    <input type="text" formControlName="witness2Name" class="form-input">
                                </div>
                                <div>
                                    <label class="form-label">Witness 3</label>
                                    <input type="text" formControlName="witness3Name" class="form-input">
                                </div>
                            </div>
                        </div>

                        <p class="required-note">* Required fields</p>

                        <!-- Modal Footer -->
                        <div class="modal-footer">
                            <button type="button" (click)="onCancel()" class="btn-secondary">
                                Cancel
                            </button>
                            <button type="submit" [disabled]="!marriageForm.valid" class="btn-save">
                                Save Record
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>