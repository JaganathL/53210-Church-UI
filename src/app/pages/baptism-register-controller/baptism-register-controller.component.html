<div class="baptism-container">
  <!-- Header Section -->
  <div class="baptism-header">
    <div class="header-top">
      <div class="header-title">
        <h1>Baptism Register â€“ Children</h1>
        <p>Manage baptism records for infants and children</p>
      </div>
      <button (click)="onAddNew()" type="button" class="btn-primary">
        <span class="material-icons">add</span>
        Add New Record
      </button>
    </div>

    <!-- Search and Filter Bar -->
    <div class="search-bar">
      <div class="search-input-wrapper">
        <span class="material-icons">search</span>
        <input type="text" [(ngModel)]="searchQuery" (ngModelChange)="onSearchChange()" class="search-input"
          placeholder="Search by name or minister...">
      </div>
      <button class="btn-filter">
        <span class="material-icons">filter_list</span>
        Filter
      </button>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-spinner">
    <div class="spinner"></div>
  </div>

  <!-- Error Message -->
  <div *ngIf="errorMessage" class="alert alert-error">
    <span class="material-icons">error</span>
    <p>{{ errorMessage }}</p>
  </div>

  <!-- Success Message -->
  <div *ngIf="successMessage" class="alert alert-success">
    <span class="material-icons">check_circle</span>
    <p>{{ successMessage }}</p>
  </div>

  <!-- Table -->
  <div class="table-container" *ngIf="!isLoading">
    <table class="baptism-table">
      <thead>
        <tr>
          <th class="sortable" (click)="onSort('dateOfBaptism')">Baptism Date</th>
          <th>Gender</th>
          <th class="sortable" (click)="onSort('christianName')">Christian Name</th>
          <th>Parents' Names</th>
          <th>Abode</th>
          <th>Minister</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let record of filteredRecords; let i = index">
          <td>{{ record.dateOfBaptism | date:'dd / MM / yyyy' }}</td>
          <td>{{ record.sex === 'MALE' ? 'Male' : 'Female' }}</td>
          <td><strong>{{ record.christianName }}</strong></td>
          <td>{{ record.parentName }}</td>
          <td>{{ record.parentAbode }}</td>
          <td>{{ record.pastorate || '-' }}</td>
          <td>
            <div class="action-buttons">
              <button (click)="onView(record)" class="action-btn" title="View">
                <span class="material-icons">visibility</span>
              </button>
              <button (click)="onEdit(record)" class="action-btn" title="Edit">
                <span class="material-icons">edit</span>
              </button>
              <button (click)="onDelete(record)" class="action-btn delete" title="Delete">
                <span class="material-icons">delete</span>
              </button>
            </div>
          </td>
        </tr>
        <tr *ngIf="filteredRecords.length === 0">
          <td colspan="8">
            <div class="empty-state">
              <span class="material-icons">search_off</span>
              <p>No records found</p>
            </div>
          </td>
        </tr>
      </tbody>
    </table>

    <!-- Pagination -->
    <div class="pagination">
      <div class="pagination-info">
        Showing <span class="font-medium">{{ currentPage * pageSize + 1 }}</span> to
        <span class="font-medium">{{ (currentPage + 1) * pageSize > totalElements ? totalElements : (currentPage + 1) *
          pageSize }}</span> of
        <span class="font-medium">{{ totalElements }}</span> results
      </div>
      <div class="pagination-controls">
        <button (click)="onPreviousPage()" [disabled]="!hasPreviousPage" class="page-btn">
          <span class="material-icons">chevron_left</span>
        </button>
        <button *ngFor="let page of getPageNumbers()" (click)="onGoToPage(page)" [class.active]="page === currentPage"
          class="page-btn">
          {{ page + 1 }}
        </button>
        <button (click)="onNextPage()" [disabled]="!hasNextPage" class="page-btn">
          <span class="material-icons">chevron_right</span>
        </button>
      </div>
    </div>
  </div>

  <!-- Modal -->
  <div *ngIf="showModal" class="modal-overlay">
    <div class="modal-backdrop" (click)="onCancel()"></div>
    <div class="modal-wrapper">
      <div class="modal-panel">
        <div class="modal-content">
          <!-- Modal Header -->
          <div class="modal-header">
            <h3>{{ isEditMode ? 'Edit' : 'Add' }} Baptism Record</h3>
            <button (click)="onCancel()" class="modal-close">
              <span class="material-icons">close</span>
            </button>
          </div>

          <form [formGroup]="baptismForm" (ngSubmit)="onSaveRecord()">
            <!-- Child Information Section -->
            <div class="form-section">
              <h4 class="section-title">Child Information</h4>
              <p class="section-subtitle">Basic details about the child</p>

              <div class="form-grid">
                <div class="form-grid-full">
                  <label class="form-label">
                    Child Name <span class="required">*</span>
                  </label>
                  <input type="text" formControlName="christianName" required class="form-input"
                    placeholder="Enter child's full name">
                </div>

                <div>
                  <label class="form-label">Gender <span class="required">*</span></label>
                  <div class="radio-group">
                    <label class="radio-label">
                      <input type="radio" formControlName="sex" value="MALE">
                      <span>Male</span>
                    </label>
                    <label class="radio-label">
                      <input type="radio" formControlName="sex" value="FEMALE">
                      <span>Female</span>
                    </label>
                  </div>
                </div>

                <div>
                  <label class="form-label">Date of Birth <span class="required">*</span></label>
                  <input type="date" formControlName="dateOfBirth" required class="form-input">
                </div>

                <div>
                  <label class="form-label">Date of Baptism <span class="required">*</span></label>
                  <input type="date" formControlName="dateOfBaptism" required class="form-input">
                </div>

                <div>
                  <label class="form-label">Where Baptized <span class="required">*</span></label>
                  <input type="text" formControlName="whereBaptized" required class="form-input">
                </div>
              </div>
            </div>

            <!-- Parents Section -->
            <div class="form-section">
              <h4 class="section-title">Parents</h4>
              <p class="section-subtitle">Father and mother information</p>

              <div class="form-grid">
                <div class="form-grid-full">
                  <label class="form-label">Father Name <span class="required">*</span></label>
                  <input type="text" formControlName="parentName" required class="form-input">
                </div>

                <div class="form-grid-full">
                  <label class="form-label">Mother Name/Abode <span class="required">*</span></label>
                  <input type="text" formControlName="parentAbode" required class="form-input">
                </div>

                <div class="form-grid-full">
                  <label class="form-label">Trade of Profession</label>
                  <input type="text" formControlName="parentProfession" class="form-input">
                </div>
              </div>
            </div>

            <!-- Godparents Section -->
            <div class="form-section">
              <h4 class="section-title">Godparents</h4>
              <p class="section-subtitle">Godfather and godmother details</p>

              <div class="form-grid">
                <div>
                  <label class="form-label">Godfather</label>
                  <input type="text" formControlName="godfather" class="form-input">
                </div>
                <div>
                  <label class="form-label">Godmother</label>
                  <input type="text" formControlName="godmother" class="form-input">
                </div>
              </div>
            </div>

            <!-- Additional Fields -->
            <div class="form-section">
              <div class="form-grid">
                <div class="form-grid-full">
                  <label class="form-label">Pastorate</label>
                  <input type="text" formControlName="pastorate" class="form-input">
                </div>
              </div>
            </div>

            <p class="required-note">* Required fields</p>

            <!-- Modal Footer -->
            <div class="modal-footer">
              <button type="button" (click)="onCancel()" class="btn-secondary">
                Cancel
              </button>
              <button type="submit" [disabled]="!baptismForm.valid" class="btn-save">
                Save Record
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>